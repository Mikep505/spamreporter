<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spam SMS Reporter</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 8px;
      margin: 10px 0;
    }
    button {
      width: auto;
      margin-right: 10px;
    }
    #result {
      background: #f4f4f4;
      padding: 1em;
      margin-top: 20px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Spam SMS Reporter</h1>
  <p>
    Have you ever received strange text messages from unknown numbers saying things like
    "How have you been?" or "What time are you picking me up?"?
  </p>
  <p>
    These are called <strong>smishing attacks</strong> — like phishing, but delivered through SMS.
    This form provides a fast, easy way to report suspicious numbers so that carriers can investigate and shut them down.
    Don’t worry about accidentally reporting legitimate wrong-number texts — carriers are able to distinguish fraud from genuine messages.
  </p>

  <form id="reportForm">
    <input type="text" name="name" placeholder="Your Name" required>
    <input type="email" name="email" placeholder="Your Email" required>
    <input type="text" name="phoneNumber" placeholder="Your Phone Number (you received message on)" required>
    <select name="countryCode" required>
      <option value="+1">🇺🇸 USA (+1)</option>
      <option value="+44">🇬🇧 UK (+44)</option>
      <option value="+61">🇦🇺 Australia (+61)</option>
      <option value="+91">🇮🇳 India (+91)</option>
      <!-- Add more countries if needed -->
    </select>
    <input type="text" name="offendingNumber" placeholder="Offending Number" required>
    <input type="date" name="date" required>
    <input type="time" name="time" required>
    <input type="text" name="timeZone" placeholder="Your Time Zone (e.g., EST, PST)" required>
    <textarea name="messageContent" rows="4" placeholder="Message Content (optional)"></textarea>
    <label><input type="checkbox" name="isIRSScam"> Check if this was an IRS scam</label>
    <button type="submit">Submit Report</button>
  </form>

  <div id="result" style="display: none;">
    <h3>Email Report</h3>
    <p><strong>To:</strong> <span id="abuseEmails"></span></p>
    <p><strong>CC:</strong> <span id="ccEmails"></span></p>
    <p><strong>Subject:</strong> <span id="emailSubject"></span></p>
    <p><strong>Body:</strong></p>
    <pre id="emailBody"></pre>

    <button onclick="copyToClipboard()">📋 Copy Email</button>
    <button onclick="downloadEML()">📩 Download .eml</button>
    <button onclick="openGmail()">📧 Open in Gmail</button>
    <button onclick="openOutlook()">📨 Open in Outlook/Hotmail</button>
    <button onclick="window.location.reload()">↩️ Report Another Number</button>
  </div>

  <script>
    document.getElementById('reportForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const json = Object.fromEntries(formData.entries());

      const response = await fetch('/submit-report', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(json)
      });

      const data = await response.json();

      document.getElementById('abuseEmails').textContent = data.abuseEmails.join(', ') || 'Unknown';
      document.getElementById('ccEmails').textContent = data.ccEmails?.join(', ') || '';
      document.getElementById('emailSubject').textContent = data.emailSubject;
      document.getElementById('emailBody').textContent = data.emailBody;

      document.getElementById('result').style.display = 'block';
    });

    function copyToClipboard() {
      const body = document.getElementById('emailBody').textContent;
      navigator.clipboard.writeText(body).then(() => alert('Copied to clipboard!'));
    }

    function downloadEML() {
      const to = document.getElementById('abuseEmails').textContent;
      const cc = document.getElementById('ccEmails').textContent;
      const subject = document.getElementById('emailSubject').textContent;
      const body = document.getElementById('emailBody').textContent;

      const eml = `To: ${to}\nCC: ${cc}\nSubject: ${subject}\n\n${body}`;
      const blob = new Blob([eml], { type: 'message/rfc822' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'spam_report.eml';
      a.click();
    }

    function openGmail() {
      const to = encodeURIComponent(document.getElementById('abuseEmails').textContent);
      const cc = encodeURIComponent(document.getElementById('ccEmails').textContent);
      const subject = encodeURIComponent(document.getElementById('emailSubject').textContent);
      const body = encodeURIComponent(document.getElementById('emailBody').textContent);

      window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${to}&cc=${cc}&su=${subject}&body=${body}`, '_blank');
    }

    function openOutlook() {
      const to = encodeURIComponent(document.getElementById('abuseEmails').textContent);
      const cc = encodeURIComponent(document.getElementById('ccEmails').textContent);
      const subject = encodeURIComponent(document.getElementById('emailSubject').textContent);
      const body = encodeURIComponent(document.getElementById('emailBody').textContent);

      window.open(`https://outlook.live.com/mail/deeplink/compose?to=${to}&cc=${cc}&subject=${subject}&body=${body}`, '_blank');
    }
  </script>
</body>
</html>

